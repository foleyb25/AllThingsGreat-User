    <div id="app" v-cloak style="padding: 24px">
        <!-- Blog posts -->
        <div class="container-fluid pt-5 pb-5">
            <H1>{{blog.title}}</H1>
            <div id="preview">
                <%- blog.bodyHTML %>
            </div>
        </div>
        <div class="container-fluid d-block d-flex justify-content-center">
            <div class="rate" id="rating-container">
                <input type="radio" id="star5" name="rate" value="5"/>
                <label for="star5" title="text">5 stars</label>
                <input type="radio" id="star4" name="rate" value="4" />
                <label for="star4" title="text">4 stars</label>
                <input type="radio" id="star3" name="rate" value="3" />
                <label for="star3" title="text">3 stars</label>
                <input type="radio" id="star2" name="rate" value="2" />
                <label for="star2" title="text">2 stars</label>
                <input type="radio" id="star1" name="rate" value="1" />
                <label for="star1" title="text">1 star</label>
                <Button class="btn btn-info btn-sm" v-on:click="clear()" type="radio" id="clear" name="rate" value="0" style="margin-top: 8px; margin-right:8px">
                    <span class="fas fa-sync-alt btn-info" aria-hidden="true"></span>
                </Button>
            </div>
        </div>
        <div class="submit-box">
            <div v-if="isRated">
                <p>Rating Submitted</p>
            </div>
            <div v-if="!isRated">
                <button class="btn btn-info" v-on:click="submitRating()" :disabled="!isLoggedIn || isRated">Submit</button>
            </div>
            <span v-if="!isLoggedIn"><a href="/signup">Sign up</a> or <a href="/login">Log in</a> to submit a rating</span>
        </div>
        
        
        
        
        <!-- COMMENTS -->
        <div class="comment-section">
            <div style="margin-bottom: 12px">
                Comments ({{blog.comments.length}})
            </div>
            <form :action="'/comment/blog/' +blog.id" method="POST">
                <div class="form-group">
                    <textarea class="form-control" name="comment" :placeholder="isLoggedIn ? 'Start typing...':'Sign up or login to submit a comment.'" :disabled="!isLoggedIn" rows="3"></textarea>
                    <br>
                    <button class="btn btn-info" :disabled="!isLoggedIn">Submit</button>
                </div>
            </form>
            <div v-for="c in blog.comments"
            style="background-color: white; padding: 16px; margin-bottom: 16px">

                <div style="display: flex">
                    <img class="center-cropped" id="center-cropped":src="!c.user.profileImageUrl ? '/images/startup.png' : c.user.profileImageUrl">
                    <div style="margin-left: 16px; justify-content: center">
                        <div style="font-weight: bold">
                                {{c.user.fullName}}
                        </div>
                        <div>
                            Posted {{c.fromNow}}
                        </div>
                    </div>
                    
                </div>
                <div class="c-text">
                    {{c.text}}
                </div>
            </div>
        </div>
    </div>


<%- exposeLocalsToBrowser({keys: ['blog', 'isRated', 'isLoggedIn']}) %>

<script>
        const App = new Vue({
            el: '#app',
            data: {
                blog: window.SAILS_LOCALS.blog,
                isRated: window.SAILS_LOCALS.isRated,
                isLoggedIn: window.SAILS_LOCALS.isLoggedIn,

            },
            methods: {
                submitRating: async function() {
                    var score = 0;
                    $('#rating-container').find('input').each(function () {
                        if(!this.checked && this.value == '1') {
                            score = 0;
                        }
                        if(this.checked) {
                            score = parseInt(this.value)
                            return false
                        } 
                    });
                    const formData = new FormData()
                    formData.append("userRating", score)
                    formData.append('blogRating', this.blog.rating)
                    formData.append('numberOfRatings', this.blog.numberOfRatings)
                    formData.append('blogId', this.blog.id)
                    try {
                        await axios.put('/blog/submitrating', formData)
                        $("#rating-container :input").attr("disabled", this.isRated);
                        location.reload()
                    } catch (err) {
                        this.isCreatingPost = false
                        console.error(err.toString())
                    }
                },
                clear: function() {
                    $('#rating-container').find('input').each(function () {
                        this.checked = false
                    });
                }
            },
            computed: {
            }
        })
    </script>

<style>
.submit-box {
    display: block;
    justify-content: center;
    text-align: center;
}

.rate {
    float: left;
    height: 46px;
}
.rate:not(:checked) > input {
    display: none;
}
.rate:not(:checked) > label {
    float:right;
    width:1em;
    overflow:hidden;
    white-space:nowrap;
    cursor:pointer;
    font-size:30px;
    color:#ccc;
}
.rate:not(:checked) > label:before {
    content: 'â˜… ';
}

.rate > input:checked ~ label {
    color: #ffc700;    
}
.rate:not(:checked) > label:hover,
.rate:not(:checked) > label:hover ~ label {
    color: #deb217;  
}
.rate > input:checked + label:hover,
.rate > input:checked + label:hover ~ label,
.rate > input:checked ~ label:hover,
.rate > input:checked ~ label:hover ~ label,
.rate > label:hover ~ input:checked ~ label {
    color: #c59b08;
}

.center-cropped {
    object-position: center; /* Center the image within the element */
    object-fit: cover;
    width: 64px;
    height: 64px;
    border-radius: 100px;
    border: solid 1px rgb(94, 94, 94);
}

.c-text {
    margin-top: 16px
}

    @media (max-width: 475px) {
    .submit-box {
        margin-top: 15px
    }

    .comment-box {
        margin-top: 15px;
    }

    iframe[width] {
        width: 100%;
    }

    iframe[height] {
        height: 196px;
    }

    img[style] {
        width: 100% !important;
        height:auto !important;
    }
}
</style>